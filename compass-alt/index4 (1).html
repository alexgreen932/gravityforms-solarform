<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link type="text/css" rel="stylesheet" href="../assets/css/style.css">
    <link type="text/css" rel="stylesheet" href="../assets/css/all.min.css">
    <script src="../assets/js/jquery-3.7.1.min.js"></script>
    <script src="../assets/js/vue.js"></script>
    <!-- <script src="../assets/js/script.js"></script> -->
    <style>
        body {
  background-color: #161a20;
  color: white;
  display: grid;
  place-items: center;
  min-height: 100vh;
}

main {
  width: 50vw;
}

.volume-button-knob {
  position: relative;
}
.volume-button-knob svg {
  display: block;
  width: 100%;
}

.circle {
  fill: #202528;
  stroke: #080516;
  stroke-width: 10px;
}

.slider-wrap {
  filter: url(#inset-shadow);
}

.slider {
  --deg: 0deg;
  --h: 270;
  --s: 60%;
  transform-origin: 50% 50%;
  transform: rotate(var(--deg));
  fill: rgba(255, 255, 255, 0.5);
  cursor: grab;
  transition: all 0.1s ease-in-out;
  fill: hsl(var(--h), var(--s), 55%);
}

.volume-button-knob.without-animate .slider {
  transition: unset;
  cursor: grabbing;
}

.gradate line {
  --deg: 0deg;
  --h: 135;
  --s: 10%;
  --a: 0.2;
  stroke-linecap: round;
  stroke-width: 10px;
  stroke: hsla(var(--h), var(--s), 55%, var(--a));
  transform: rotate(var(--deg));
  transform-origin: 50% 50%;
}
.gradate line:hover, .gradate line.active {
  --a: 1;
  --s: 60%;
  filter: url(#shadow);
}
        
    </style>
</head>

<body>
    <div id="app">
        <main>
            <input type="range" min="-135" max="135" step="13.5" id="inputRange">
            <div class="volume-button-knob">
                <svg viewBox="0 0 600 600">
                    <defs>
                        <radialGradient id="radial-gradient" cx="0.5" cy="0.5" r="0.5" gradientUnits="objectBoundingBox">
                            <stop offset="0" stop-color="#202528" />
                            <stop offset="0.849" stop-color="#272c2f" />
                            <stop offset="0.866" stop-color="#6a6d6f" />
                            <stop offset="0.87" stop-color="#202528" />
                            <stop offset="0.879" stop-color="#6a6d6f" />
                            <stop offset="0.908" stop-color="#202528" />
                            <stop offset="1" stop-color="#6a6d6f" />
                        </radialGradient>
                        <filter id="shadow" filterUnits="userSpaceOnUse">
                            <feOffset input="SourceAlpha" />
                            <feGaussianBlur stdDeviation="5" result="blur" />
                            <feFlood result="color" />
                            <feComposite operator="in" in="blur" />
                            <feComposite in="SourceGraphic" />
                        </filter>
                        <filter id="inset-shadow">
                            <feOffset input="SourceAlpha" />
                            <feGaussianBlur stdDeviation="3" result="blur" />
                            <feFlood result="color" />
                            <feComposite operator="out" in="SourceGraphic" in2="blur" />
                            <feComposite operator="in" in="color" />
                            <feComposite operator="in" in2="SourceGraphic" />
                        </filter>
                    </defs>
                    <circle class="circle" cx="300" cy="300" r="200" />
                    <g id="gradate" class="gradate"></g>
                    <circle id="slider" class="slider" cx="300" cy="130" r="10" />
                    <g class="slider-wrap">
                        <circle id="slider-shadow" class="slider" cx="300" cy="130" r="10" />
                    </g>
        
                </svg>
        
            </div>
        </main>
        
    </div>
    <script type="module">
        "use strict";
const STEP = 32;
const DEG_RANGE = 135;
const gradateGroup = document.querySelector("#gradate");
const inputRange = document.querySelector("#inputRange");
const slider = document.querySelector("#slider");
const sliderShadow = document.querySelector("#slider-shadow");
const gradateLineTemplate = (deg, hue) => `<line data-deg="${deg}" class="active" style="--deg: ${deg}deg; --h: ${hue}" x1="300" y1="30" x2="300" y2="70" />`;
let gradateLines = ``;
const Q = DEG_RANGE / STEP;
for (let i = DEG_RANGE * -1; i <= DEG_RANGE; i += Q) {
    gradateLines += gradateLineTemplate(i, i + DEG_RANGE * 2);
}
gradateGroup.innerHTML = gradateLines;
gradateLines = gradateGroup.querySelectorAll("line");
function deactiveAll() {
    gradateLines.forEach((l) => {
        l.classList.remove("active");
    });
}
function active(v) {
    for (let i = 0; i < gradateLines.length; i++) {
        const l = gradateLines[i];
        if (parseFloat(l.dataset.deg) <= v)
            l.classList.add("active");
    }
}
inputRange.addEventListener("input", (e) => {
    const V = inputRange.value;
    console.log(V);
    setValue(V);
});
function setValue(v) {
    deactiveAll();
    active(v);
    slider.style.setProperty("--deg", `${v}deg`);
    sliderShadow.style.setProperty("--deg", `${v}deg`);
    slider.style.setProperty("--h", `${v * 1 + DEG_RANGE * 2}`);
}
setValue(0);
/**/
// https://stackoverflow.com/questions/42110701/how-to-calculate-percentage-between-the-range-of-two-values-a-third-value-is-in
function mapBetween(currentNum, minAllowed, maxAllowed, min, max) {
    return (((maxAllowed - minAllowed) * (currentNum - min)) / (max - min) + minAllowed);
}
const getRangeNumber = (percent, min, max) => mapBetween(percent, min, max, 0, 100);
const getRangePercent = (number, min, max) => mapBetween(number, 0, 100, min, max);
const volumeButtonKnob = document.querySelector(".volume-button-knob");
volumeButtonKnob.addEventListener("click", clickHandler);
const toRadians = (degrees) => (degrees / 180) * Math.PI;
const getRadians = (x, y) => Math.atan2(y, x);
const toDegrees = (radians) => (radians / Math.PI) * 180;
function setByCoords(clientX, clientY) {
    const rect = volumeButtonKnob.getBoundingClientRect();
    const CX = rect.width / 2;
    const CY = rect.height / 2;
    const x = clientX - rect.left;
    const y = clientY - rect.top;
    const r = getRadians(x - CX, y - CY);
    const res = Math.round(toDegrees(r)) + 90;
    let value = res <= 180 ? res : res - 360;
    value = value <= DEG_RANGE * -1 ? DEG_RANGE * -1 : value;
    value = value >= DEG_RANGE ? DEG_RANGE : value;
    setValue(value);
    inputRange.value = value;
}
function clickHandler(e) {
    setByCoords(e.clientX, e.clientY);
}
sliderShadow.onmousedown = (e) => {
    //
    volumeButtonKnob.classList.add("without-animate");
    volumeButtonKnob.onmousemove = clickHandler;
    volumeButtonKnob.style.cursor = "grabbing";
    document.addEventListener("mouseup", (e) => {
        volumeButtonKnob.onmousemove = null;
        volumeButtonKnob.classList.remove("without-animate");
        volumeButtonKnob.style.cursor = "unset";
    });
};
sliderShadow.ontouchstart = (e) => {
    volumeButtonKnob.classList.add("without-animate");
    document.ontouchmove = function (e) {
        const movePageX = e.touches[0].pageX;
        const movePageY = e.touches[0].pageY;
        setByCoords(movePageX, movePageY);
    };
    document.ontouchend = function (e) {
        volumeButtonKnob.classList.remove("without-animate");
    };
};


    </script>
</body>

</html>